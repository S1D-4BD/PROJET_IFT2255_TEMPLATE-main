<!DOCTYPE html>
<html lang="en">
<head>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>projet ift2255</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>OUTIL DE CONSEILS PLANIFIUM</h1>
        <div class="student-info">
            <h2><b>Espace de</b> <span id="student-name"></span></h2>
            <p><b>Matricule:</b> <span id="student-matricule"></span></p>
            <p><b>Cours complétés:</b> <span id="completed-courses"></span></p>
            <button onclick="logout()">Déconnexion</button>
        </div>
        <section>
            <h2>Étudiants inscrits</h2>
            <button onclick="loadUsers()">Charger les etudiants</button>
            <div id="users-list"></div>
        </section>

        <section>
            <h2>Courses</h2>
            <div>
                <input type="text" id="courseId" placeholder="Ex: mat1400">
                <button onclick="loadCourse()">Chercher le cours</button>
            </div>
            <div id="course-info"></div>
        </section>

        <section>
        <h2>Avis form</h2>

            <div>
                <h3>Consulter les avis</h3>
                <input type="text" id="avis-search-coursebyid" placeholder="Ex: IFT1015">
                <button onclick="loadAvis()">Voir les avis</button>
                <button onclick="loadAvisStats()">Voir les stats</button>
                <div id="avis-list"></div>
            </div>

            <div style="margin-top: 20px;">
                <h3>Laisser un avis</h3>
                <form id="createAvisForm">
                    <input type="text" id="avis-courseId" placeholder="Sigle (ex: IFT1015)" required>
                    <input type="number" id="avis-rating" placeholder="Note (1-5)" min="1" max="5" required>
                    <input type="number" id="avis-difficulty" placeholder="Difficulté (1-5)" min="1" max="5" required>
                    <input type="number" id="avis-charge" placeholder="Charge (1-5)" min="1" max="5" required>
                    <input type="text" id="avis-comment" placeholder="Commentaire" required>
                    <button type="submit">Envoyer</button>
                </form>
                <div id="avis-form-result"></div>
            </div>
        </section>

        <section>
            <h2>modifier une personne ??(juste tgde)</h2>
            <form id="createUserForm">
                <input type="text" id="userName" placeholder="Nom" required>
                <input type="matricule" id="userMatricule" placeholder="Matricule" required>
                <button type="submit">Créer</button>
            </form>
        </section>


    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const matricule = params.get('matricule');

        if (!matricule) {
            window.location.href = "landing.html";
            //oui cpas le top securité mais anyways
        }

        let currentStudent = null; //fetch les info de la personne
        async function loadStudent() {
            const response = await fetch(`http://localhost:3000/students/${matricule}`);
            currentStudent = await response.json();

            document.getElementById('student-name').textContent = currentStudent.name;
            document.getElementById('student-matricule').textContent = currentStudent.matricule;
            document.getElementById('completed-courses').textContent =
                currentStudent.completedCourses.join(', ') || 'Aucun cours credité';
        }

        loadStudent();
    </script>
        <script src="app.js"></script>
</body>
</html>